"use strict";(self.webpackChunkapp_scaffold=self.webpackChunkapp_scaffold||[]).push([[5569],{"./src/app/cases/[id]/components/PhotoViewer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>PhotoViewer});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),EditableText=__webpack_require__("./src/app/components/EditableText.tsx"),localizedText=__webpack_require__("./src/lib/localizedText.ts"),es=__webpack_require__("./node_modules/.pnpm/react-i18next@15.6.0_i18next@25.3.1_typescript@5.8.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.8.3/node_modules/react-i18next/dist/es/index.js"),InlineTranslateButton=__webpack_require__("./src/app/components/InlineTranslateButton.tsx");function ImageHighlights({analysis,photo,onTranslate}){var _analysis_images;const{i18n,t}=(0,es.Bd)(),name=photo.split("/").pop()||photo,info=null===(_analysis_images=analysis.images)||void 0===_analysis_images?void 0:_analysis_images[name];if(!info)return null;const{text:highlights,needsTranslation:needsHighlights}=(0,localizedText.P)(info.highlights,i18n.language),{text:context,needsTranslation:needsContext}=(0,localizedText.P)(info.context,i18n.language);return(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("span",{className:"font-semibold",children:"Image score:"})," ",info.representationScore.toFixed(2)]}),highlights?(0,jsx_runtime.jsxs)("span",{children:[highlights,needsHighlights?(0,jsx_runtime.jsx)(InlineTranslateButton.A,{lang:i18n.language,onTranslate:()=>null==onTranslate?void 0:onTranslate(`analysis.images.${name}.highlights`,i18n.language)}):null]}):null,context?(0,jsx_runtime.jsxs)("span",{children:[context,needsContext?(0,jsx_runtime.jsx)(InlineTranslateButton.A,{lang:i18n.language,onTranslate:()=>null==onTranslate?void 0:onTranslate(`analysis.images.${name}.context`,i18n.language)}):null]}):null]})}ImageHighlights.__docgenInfo={description:"",methods:[],displayName:"ImageHighlights",props:{analysis:{required:!0,tsType:{name:"ViolationReport"},description:""},photo:{required:!0,tsType:{name:"string"},description:""},onTranslate:{required:!1,tsType:{name:"signature",type:"function",raw:"(path: string, lang: string) => Promise<void> | void",signature:{arguments:[{type:{name:"string"},name:"path"},{type:{name:"string"},name:"lang"}],return:{name:"union",raw:"Promise<void> | void",elements:[{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"},{name:"void"}]}}},description:""}}};var react=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js"),index_esm=__webpack_require__("./node_modules/.pnpm/react-zoom-pan-pinch@3.7.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/react-zoom-pan-pinch/dist/index.esm.js");function ZoomableImage({src,alt}){const[scale,setScale]=(0,react.useState)(1);return(0,jsx_runtime.jsx)(index_esm.GT,{maxScale:5,wheel:{step:.2},onZoomStop:ref=>setScale(ref.state.scale),onPanningStop:ref=>setScale(ref.state.scale),children:({resetTransform})=>(0,jsx_runtime.jsxs)("div",{className:"w-full h-full relative",children:[(0,jsx_runtime.jsx)(index_esm.WZ,{wrapperClass:"w-full h-full",contentClass:"w-full h-full",children:(0,jsx_runtime.jsx)("img",{src,alt,draggable:!1,className:"object-contain select-none w-full h-full",loading:"lazy"})}),scale>1?(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>resetTransform(),className:"absolute top-1 left-1 z-sticky bg-black/60 text-white rounded px-1 text-xs",children:"Reset zoom"}):null]})})}ZoomableImage.__docgenInfo={description:"",methods:[],displayName:"ZoomableImage",props:{src:{required:!0,tsType:{name:"string"},description:""},alt:{required:!0,tsType:{name:"string"},description:""}}};var dropdown_menu=__webpack_require__("./src/components/ui/dropdown-menu.tsx"),ui_progress=__webpack_require__("./src/components/ui/progress.tsx");function PhotoViewer({caseData,selectedPhoto,progress,progressDescription,requestValue,isPhotoReanalysis,reanalyzingPhoto,analysisActive,readOnly,photoNote,updatePhotoNote,removePhoto,reanalyzePhoto,onTranslate}){const{t}=(0,es.Bd)(),time=caseData.photoTimes[selectedPhoto];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"relative w-full aspect-[3/2] md:max-w-2xl shrink-0",children:[(0,jsx_runtime.jsx)(ZoomableImage,{src:`/uploads/${selectedPhoto}`,alt:t("casePreview")}),isPhotoReanalysis&&reanalyzingPhoto===selectedPhoto?(0,jsx_runtime.jsx)("div",{className:"absolute top-0 left-0 right-0",children:(0,jsx_runtime.jsx)(ui_progress.k,{value:requestValue,indeterminate:void 0===requestValue})}):null,readOnly?null:(0,jsx_runtime.jsxs)(dropdown_menu.rI,{children:[(0,jsx_runtime.jsx)(dropdown_menu.ty,{asChild:!0,children:(0,jsx_runtime.jsx)("button",{type:"button",className:"absolute top-1 right-1 text-white cursor-pointer select-none bg-black/40 rounded px-1 opacity-70","aria-label":t("photoActionsMenu"),children:"⋮"})}),(0,jsx_runtime.jsxs)(dropdown_menu.SQ,{align:"end",className:"mt-1",children:[(0,jsx_runtime.jsx)(dropdown_menu._2,{asChild:!0,children:(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>reanalyzePhoto(selectedPhoto),className:"w-full text-left",disabled:"pending"===caseData.analysisStatus&&analysisActive,children:t("reanalyzePhoto")})}),(0,jsx_runtime.jsx)(dropdown_menu._2,{asChild:!0,children:(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>removePhoto(selectedPhoto),className:"w-full text-left",children:t("deleteImage")})})]})]}),caseData.analysis?(0,jsx_runtime.jsx)("div",{className:"group absolute bottom-0 left-0 right-0 bg-black/60 text-white p-2 text-sm max-h-20 overflow-hidden hover:max-h-none hover:overflow-visible active:max-h-none active:overflow-visible",children:(0,jsx_runtime.jsxs)("div",{className:"space-y-1 line-clamp-4 group-hover:line-clamp-none active:line-clamp-none",children:[(0,jsx_runtime.jsx)(ImageHighlights,{analysis:caseData.analysis,photo:selectedPhoto,onTranslate:path=>onTranslate(path)}),progress?(0,jsx_runtime.jsx)("p",{children:progressDescription}):null]})}):(0,jsx_runtime.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white p-2 text-sm",children:progressDescription})]}),time?(0,jsx_runtime.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("taken",{time:new Date(time).toLocaleString()})}):null,(0,jsx_runtime.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(0,jsx_runtime.jsx)("span",{className:"font-semibold",children:t("note")})," ",readOnly?(0,jsx_runtime.jsx)("span",{children:photoNote||""}):(0,jsx_runtime.jsx)(EditableText.A,{value:photoNote,onSubmit:updatePhotoNote,onClear:photoNote?()=>updatePhotoNote(""):void 0,placeholder:t("add")})]})]})}PhotoViewer.__docgenInfo={description:"",methods:[],displayName:"PhotoViewer",props:{caseData:{required:!0,tsType:{name:"Case"},description:""},selectedPhoto:{required:!0,tsType:{name:"string"},description:""},progress:{required:!0,tsType:{name:"union",raw:"LlmProgress | null",elements:[{name:"union",raw:'| {\n    stage: "upload";\n    index: number;\n    total: number;\n    step?: number;\n    steps?: number;\n  }\n| {\n    stage: "stream";\n    received: number;\n    total: number;\n    done: boolean;\n    step?: number;\n    steps?: number;\n  }\n| {\n    stage: "retry";\n    attempt: number;\n    reason: string;\n    step?: number;\n    steps?: number;\n  }',elements:[{name:"signature",type:"object",raw:'{\n  stage: "upload";\n  index: number;\n  total: number;\n  step?: number;\n  steps?: number;\n}',signature:{properties:[{key:"stage",value:{name:"literal",value:'"upload"',required:!0}},{key:"index",value:{name:"number",required:!0}},{key:"total",value:{name:"number",required:!0}},{key:"step",value:{name:"number",required:!1}},{key:"steps",value:{name:"number",required:!1}}]}},{name:"signature",type:"object",raw:'{\n  stage: "stream";\n  received: number;\n  total: number;\n  done: boolean;\n  step?: number;\n  steps?: number;\n}',signature:{properties:[{key:"stage",value:{name:"literal",value:'"stream"',required:!0}},{key:"received",value:{name:"number",required:!0}},{key:"total",value:{name:"number",required:!0}},{key:"done",value:{name:"boolean",required:!0}},{key:"step",value:{name:"number",required:!1}},{key:"steps",value:{name:"number",required:!1}}]}},{name:"signature",type:"object",raw:'{\n  stage: "retry";\n  attempt: number;\n  reason: string;\n  step?: number;\n  steps?: number;\n}',signature:{properties:[{key:"stage",value:{name:"literal",value:'"retry"',required:!0}},{key:"attempt",value:{name:"number",required:!0}},{key:"reason",value:{name:"string",required:!0}},{key:"step",value:{name:"number",required:!1}},{key:"steps",value:{name:"number",required:!1}}]}}]},{name:"null"}]},description:""},progressDescription:{required:!0,tsType:{name:"string"},description:""},requestValue:{required:!0,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:""},isPhotoReanalysis:{required:!0,tsType:{name:"boolean"},description:""},reanalyzingPhoto:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},analysisActive:{required:!0,tsType:{name:"boolean"},description:""},readOnly:{required:!0,tsType:{name:"boolean"},description:""},photoNote:{required:!0,tsType:{name:"string"},description:""},updatePhotoNote:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},removePhoto:{required:!0,tsType:{name:"signature",type:"function",raw:"(photo: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"photo"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},reanalyzePhoto:{required:!0,tsType:{name:"signature",type:"function",raw:"(photo: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"photo"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onTranslate:{required:!0,tsType:{name:"signature",type:"function",raw:"(path: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"path"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}}},"./src/app/components/EditableText.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>EditableText});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),_react_aria_textfield__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@react-aria+textfield@3.17.5_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/@react-aria/textfield/dist/useTextField.mjs"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js");function EditableText({value,onSubmit,onClear,placeholder,options}){const[editing,setEditing]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[text,setText]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(value),inputRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),listId=(0,react__WEBPACK_IMPORTED_MODULE_1__.useId)(),{inputProps}=(0,_react_aria_textfield__WEBPACK_IMPORTED_MODULE_2__.v)({value:text,onChange:setText},inputRef);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setText(value)},[value]),editing?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{ref:inputRef,...inputProps,type:"text",placeholder,list:options?listId:void 0,onBlur:async function finish(){setEditing(!1),text!==value&&await onSubmit(text)},onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.blur()},className:"border p-1 text-sm"}),options?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("datalist",{id:listId,children:options.map(o=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("option",{value:o},o))}):null]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:value||placeholder}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",onClick:function start(){setEditing(!0),setTimeout(()=>{var _inputRef_current,_inputRef_current1;null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.focus(),null===(_inputRef_current1=inputRef.current)||void 0===_inputRef_current1||_inputRef_current1.select()},0)},className:"text-gray-500 dark:text-gray-400",children:"✎"}),onClear&&value?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{type:"button",onClick:onClear,className:"text-gray-500 dark:text-gray-400",children:"×"}):null]})}EditableText.__docgenInfo={description:"",methods:[],displayName:"EditableText",props:{value:{required:!0,tsType:{name:"string"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(v: string) => Promise<void> | void",signature:{arguments:[{type:{name:"string"},name:"v"}],return:{name:"union",raw:"Promise<void> | void",elements:[{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"},{name:"void"}]}}},description:""},onClear:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void> | void",signature:{arguments:[],return:{name:"union",raw:"Promise<void> | void",elements:[{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"},{name:"void"}]}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"unknown"},description:""}}}},"./src/components/ui/dropdown-menu.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SQ:()=>DropdownMenuContent,_2:()=>DropdownMenuItem,rI:()=>DropdownMenu,ty:()=>DropdownMenuTrigger});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@radix-ui+react-dropdown-menu@2.1.15_@types+react-dom@19.1.6_@types+react@19.1.8__@types+reac_ezm2pj3ogfhslhoicxmyhw5anq/node_modules/@radix-ui/react-dropdown-menu/dist/index.mjs"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js");const DropdownMenu=_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.bL,DropdownMenuTrigger=_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.l9,DropdownMenuContent=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({className,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.ZL,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.UC,{ref,className:`bg-white dark:bg-gray-900 border rounded shadow text-black dark:text-white ${null!=className?className:""}`,sideOffset:4,...props})}));DropdownMenuContent.displayName=_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.UC.displayName;const DropdownMenuItem=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({className,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.q7,{ref,className:`block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 outline-none ${null!=className?className:""}`,...props}));DropdownMenuItem.displayName=_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.q7.displayName;const DropdownMenuSeparator=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef(({className,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.wv,{ref,className:`h-px bg-gray-300 dark:bg-gray-700 my-1 ${null!=className?className:""}`,...props}));DropdownMenuSeparator.displayName=_radix_ui_react_dropdown_menu__WEBPACK_IMPORTED_MODULE_2__.wv.displayName,DropdownMenuContent.__docgenInfo={description:"",methods:[]},DropdownMenuItem.__docgenInfo={description:"",methods:[]},DropdownMenuSeparator.__docgenInfo={description:"",methods:[]}},"./src/components/ui/progress.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>Progress});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@radix-ui+react-progress@1.1.7_@types+react-dom@19.1.6_@types+react@19.1.8__@types+react@19.1_jdeghzekregh72hrlawcc3pvvu/node_modules/@radix-ui/react-progress/dist/index.mjs");const Progress=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js").forwardRef(({value,indeterminate,className,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_2__.bL,{ref,className:`relative h-2 w-full overflow-hidden rounded-full bg-gray-300 dark:bg-gray-700 ${null!=className?className:""}`,...props,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_progress__WEBPACK_IMPORTED_MODULE_2__.C1,{className:"h-full w-full bg-blue-600 transition-transform "+(indeterminate?"animate-progress":""),style:{transform:`translateX(-${100-(null!=value?value:0)}%)`}})}));Progress.displayName="Progress",Progress.__docgenInfo={description:"",methods:[],displayName:"Progress",props:{value:{required:!1,tsType:{name:"number"},description:""},indeterminate:{required:!1,tsType:{name:"boolean"},description:""}}}}}]);