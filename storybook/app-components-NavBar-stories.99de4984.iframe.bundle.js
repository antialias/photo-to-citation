"use strict";(self.webpackChunkapp_scaffold=self.webpackChunkapp_scaffold||[]).push([[1360],{"./src/app/components/LanguageSwitcher.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G2:()=>LANGUAGE_NAMES,Ay:()=>LanguageSwitcher});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),i18next=__webpack_require__("./node_modules/.pnpm/i18next@25.3.1_typescript@5.8.3/node_modules/i18next/dist/esm/i18next.js");__webpack_require__("./node_modules/.pnpm/react-i18next@15.6.0_i18next@25.3.1_typescript@5.8.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.8.3/node_modules/react-i18next/dist/es/index.js"),__webpack_require__("./public/locales/en/common.json"),__webpack_require__("./public/locales/es/common.json"),__webpack_require__("./public/locales/fr/common.json");const instance=i18next.Ay.createInstance();const i18n=instance,FLAGS={en:"ðŸ‡ºðŸ‡¸",es:"ðŸ‡ªðŸ‡¸",fr:"ðŸ‡«ðŸ‡·"},LANGUAGE_NAMES={en:"English",es:"EspaÃ±ol",fr:"FranÃ§ais"};function LanguageSwitcher({id,value=i18n.language,onChange,immediate=!0}){return(0,jsx_runtime.jsxs)("select",{id,className:"border rounded p-1 text-sm bg-white dark:bg-gray-800",value,onChange:e=>{const lang=e.target.value;immediate&&(document.cookie=`language=${lang}; path=/; max-age=31536000`,i18n.changeLanguage(lang)),null==onChange||onChange(lang)},children:[(0,jsx_runtime.jsx)("option",{value:"en","aria-label":LANGUAGE_NAMES.en,children:FLAGS.en}),(0,jsx_runtime.jsx)("option",{value:"es","aria-label":LANGUAGE_NAMES.es,children:FLAGS.es}),(0,jsx_runtime.jsx)("option",{value:"fr","aria-label":LANGUAGE_NAMES.fr,children:FLAGS.fr})]})}LanguageSwitcher.__docgenInfo={description:"",methods:[],displayName:"LanguageSwitcher",props:{id:{required:!1,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"i18n.language",computed:!0}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(lang: string) => void",signature:{arguments:[{type:{name:"string"},name:"lang"}],return:{name:"void"}}},description:""},immediate:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}}},"./src/app/components/NavBar.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>NavBar_stories});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js"),useNewCaseFromFiles=__webpack_require__("./src/app/useNewCaseFromFiles.ts"),useSession=__webpack_require__("./src/app/useSession.ts"),dist=__webpack_require__("./node_modules/.pnpm/@radix-ui+react-popover@1.1.14_@types+react-dom@19.1.6_@types+react@19.1.8__@types+react@19.1_pyqmioko53yxjnlrzhv5y3hiqq/node_modules/@radix-ui/react-popover/dist/index.mjs"),next_image=__webpack_require__("./node_modules/.pnpm/@storybook+nextjs@8.6.14_esbuild@0.25.5_next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@_htn273eqkwxmbpgcwhwcuzbpny/node_modules/@storybook/nextjs/dist/images/next-image.mjs"),next_link=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),navigation=__webpack_require__("./node_modules/.pnpm/@storybook+nextjs@8.6.14_esbuild@0.25.5_next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@_htn273eqkwxmbpgcwhwcuzbpny/node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),react=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js"),es=__webpack_require__("./node_modules/.pnpm/react-i18next@15.6.0_i18next@25.3.1_typescript@5.8.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.8.3/node_modules/react-i18next/dist/es/index.js"),index_esm=__webpack_require__("__barrel_optimize__?names=FaBars,FaUserCircle!=!./node_modules/.pnpm/react-icons@4.12.0_react@19.1.0/node_modules/react-icons/fa/index.esm.js"),css=__webpack_require__("./styled-system/css/index.mjs"),tokens=__webpack_require__("./styled-system/tokens/index.mjs"),LanguageSwitcher=__webpack_require__("./src/app/components/LanguageSwitcher.tsx");function SystemLanguageBanner({lang,onSwitch,onDismiss}){const{i18n}=(0,es.Bd)(),t=i18n.getFixedT(lang);return(0,jsx_runtime.jsxs)("div",{className:"bg-blue-100 border border-blue-300 text-blue-800 p-2 flex items-center justify-between",children:[(0,jsx_runtime.jsx)("span",{children:t("systemLanguagePrompt",{language:LanguageSwitcher.G2[lang]})}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("button",{type:"button",onClick:onSwitch,className:"underline",children:t("switch")}),(0,jsx_runtime.jsx)("button",{type:"button",onClick:onDismiss,"aria-label":t("claimBanner.dismiss"),className:"text-xl leading-none",children:"Ã—"})]})]})}function NavBar(){var _session_user,_session_user1,_session_user2,_session_user3;const pathname=(0,navigation.usePathname)(),uploadCase=(0,useNewCaseFromFiles.A)(),inputRef=(0,react.useRef)(null),{data:session}=(0,useSession.wV)(),{i18n,t}=(0,es.Bd)(),[menuOpen,setMenuOpen]=(0,react.useState)(!1),[systemLang,setSystemLang]=(0,react.useState)(null),[showLangPrompt,setShowLangPrompt]=(0,react.useState)(!1);if((0,react.useEffect)(()=>{if("undefined"==typeof navigator)return;const supported=["en","es","fr"];var _navigator_languages;for(const l of null!==(_navigator_languages=navigator.languages)&&void 0!==_navigator_languages?_navigator_languages:[]){const code=l.toLowerCase().split("-")[0];if(supported.includes(code)){setSystemLang(code);break}}},[]),(0,react.useEffect)(()=>{systemLang&&systemLang!==i18n.language&&setShowLangPrompt(!0)},[systemLang,i18n.language]),pathname.startsWith("/point")){const styles={wrapper:(0,css.AH)({p:"2",display:"flex",justifyContent:"flex-end",bg:{base:"gray.100",_dark:"gray.900"},color:{base:"gray.900",_dark:"gray.100"}}),link:(0,css.AH)({fontSize:"sm",textDecorationLine:"underline"})};return(0,jsx_runtime.jsx)("nav",{className:styles.wrapper,children:(0,jsx_runtime.jsx)(link_default(),{href:"/cases",className:styles.link,children:t("nav.cases")})})}const navStyles={link:(0,css.AH)({_hover:{color:{base:"gray.600",_dark:"gray.300"}}})},navLinks=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{type:"button",className:navStyles.link,onClick:()=>{var _inputRef_current;setMenuOpen(!1),null===(_inputRef_current=inputRef.current)||void 0===_inputRef_current||_inputRef_current.click()},children:t("nav.newCaseFromImage")}),(0,jsx_runtime.jsx)(link_default(),{href:"/point",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.pointShoot")}),(0,jsx_runtime.jsx)(link_default(),{href:"/cases",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.cases")}),(0,jsx_runtime.jsx)(link_default(),{href:"/map",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.mapView")}),(0,jsx_runtime.jsx)(link_default(),{href:"/snail-mail",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.snailMail")}),session?(0,jsx_runtime.jsx)(link_default(),{href:"/triage",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.triage")}):null,"admin"===(null==session||null===(_session_user=session.user)||void 0===_session_user?void 0:_session_user.role)||"superadmin"===(null==session||null===(_session_user1=session.user)||void 0===_session_user1?void 0:_session_user1.role)?(0,jsx_runtime.jsx)(link_default(),{href:"/admin",className:navStyles.link,onClick:()=>setMenuOpen(!1),children:t("nav.admin")}):null]}),userStyles={details:(0,css.AH)({position:"relative"}),summary:(0,css.AH)({cursor:"pointer",listStyle:"none",display:"flex",alignItems:"center"}),avatar:(0,css.AH)({width:"1.5rem",height:"1.5rem",borderRadius:"9999px",objectFit:"cover"}),menu:(0,css.AH)({position:"absolute",right:0,mt:"1",bg:{base:"white",_dark:"gray.900"},borderWidth:"1px",borderRadius:(0,tokens.S)("radii.md"),boxShadow:(0,tokens.S)("shadows.md"),fontSize:"sm"}),menuItem:(0,css.AH)({display:"block",px:"4",py:"2",textAlign:"left",_hover:{bg:{base:"gray.100",_dark:"gray.700"}}})},userMenu=(0,jsx_runtime.jsxs)("details",{className:userStyles.details,onToggle:()=>setMenuOpen(!1),children:[(0,jsx_runtime.jsx)("summary",{className:userStyles.summary,children:(null==session||null===(_session_user2=session.user)||void 0===_session_user2?void 0:_session_user2.image)?(0,jsx_runtime.jsx)(next_image.A,{src:session.user.image,alt:"avatar",width:24,height:24,className:userStyles.avatar}):(0,jsx_runtime.jsx)(index_esm.NBi,{className:userStyles.avatar})}),(0,jsx_runtime.jsx)("div",{className:userStyles.menu,children:session?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(link_default(),{href:"/settings",className:userStyles.menuItem,children:t("nav.userSettings")}),(0,jsx_runtime.jsx)(link_default(),{href:`/public/users/${null===(_session_user3=session.user)||void 0===_session_user3?void 0:_session_user3.id}`,className:userStyles.menuItem,children:t("nav.publicProfile")}),(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>(0,useSession.CI)(),className:userStyles.menuItem,children:t("nav.signOut")})]}):(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>(0,useSession.Jv)(),className:userStyles.menuItem,children:t("nav.signIn")})})]});return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[showLangPrompt&&systemLang?(0,jsx_runtime.jsx)(SystemLanguageBanner,{lang:systemLang,onSwitch:async()=>{document.cookie=`language=${systemLang}; path=/; max-age=31536000`,session&&await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({language:systemLang})}),i18n.changeLanguage(systemLang),setShowLangPrompt(!1)},onDismiss:()=>setShowLangPrompt(!1)}):null,(0,jsx_runtime.jsxs)("nav",{className:(0,css.AH)({py:"4",px:"8",display:"flex",alignItems:"center",justifyContent:"space-between",bg:{base:"gray.100",_dark:"gray.900"},color:{base:"gray.900",_dark:"gray.100"},position:"sticky",top:0,zIndex:"var(--z-nav)"}),children:[(0,jsx_runtime.jsx)(link_default(),{href:"/",className:(0,css.AH)({fontSize:"lg",fontWeight:"semibold",_hover:{color:{base:"gray.600",_dark:"gray.300"}}}),children:t("title")}),(0,jsx_runtime.jsx)("input",{type:"file",accept:"image/*",multiple:!0,hidden:!0,ref:inputRef,onChange:e=>uploadCase(e.target.files)}),(0,jsx_runtime.jsxs)("div",{className:(0,css.AH)({display:{base:"none",sm:"flex"},gap:{base:"4",sm:"6",md:"8"},fontSize:"sm",alignItems:"center"}),children:[navLinks,userMenu]}),(0,jsx_runtime.jsxs)("div",{className:(0,css.AH)({display:{base:"flex",sm:"none"},alignItems:"center",gap:"2"}),children:[(0,jsx_runtime.jsxs)(dist.bL,{open:menuOpen,onOpenChange:setMenuOpen,children:[(0,jsx_runtime.jsx)(dist.l9,{asChild:!0,children:(0,jsx_runtime.jsx)("button",{type:"button",className:(0,css.AH)({display:{sm:"none"},fontSize:"xl",p:"2",_hover:{color:{base:"gray.600",_dark:"gray.300"}}}),"aria-label":t("menu"),children:(0,jsx_runtime.jsx)(index_esm.OXb,{})})}),(0,jsx_runtime.jsx)(dist.ZL,{children:(0,jsx_runtime.jsx)(dist.UC,{sideOffset:4,className:(0,css.AH)({display:{base:"flex",sm:"none"},flexDirection:"column",gap:"2",fontSize:"sm",bg:{base:"gray.100",_dark:"gray.900"},borderWidth:"1px",borderRadius:(0,tokens.S)("radii.md"),boxShadow:(0,tokens.S)("shadows.md"),p:"4"}),children:navLinks})})]}),userMenu]})]})]})}SystemLanguageBanner.__docgenInfo={description:"",methods:[],displayName:"SystemLanguageBanner",props:{lang:{required:!0,tsType:{name:"string"},description:""},onSwitch:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onDismiss:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},NavBar.__docgenInfo={description:"",methods:[],displayName:"NavBar"};const NavBar_stories={component:NavBar,title:"Components/NavBar"},Default={render:()=>(0,jsx_runtime.jsx)(NavBar,{})},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  render: () => <NavBar />\n}",...Default.parameters?.docs?.source}}}},"./src/app/components/NotificationProvider.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>useNotify});__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js");var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/index.js");__webpack_require__("./node_modules/.pnpm/react-hot-toast@2.5.2_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/react-hot-toast/dist/index.mjs");const NotifyContext=(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(()=>{});function useNotify(){return(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(NotifyContext)}},"./src/app/useNewCaseFromFiles.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>useNewCaseFromFiles});var _apiClient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/apiClient.ts"),_tanstack_react_query__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@tanstack+react-query@5.81.5_react@19.1.0/node_modules/@tanstack/react-query/build/modern/useMutation.js"),next_navigation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@storybook+nextjs@8.6.14_esbuild@0.25.5_next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@_htn273eqkwxmbpgcwhwcuzbpny/node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),react_i18next__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react-i18next@15.6.0_i18next@25.3.1_typescript@5.8.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.8.3/node_modules/react-i18next/dist/es/index.js"),_components_NotificationProvider__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/app/components/NotificationProvider.tsx");function useNewCaseFromFiles(){const router=(0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.useRouter)(),notify=(0,_components_NotificationProvider__WEBPACK_IMPORTED_MODULE_3__.l)(),{t}=(0,react_i18next__WEBPACK_IMPORTED_MODULE_2__.Bd)(),uploadMutation=(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_4__.n)({mutationFn:async formData=>(0,_apiClient__WEBPACK_IMPORTED_MODULE_0__.n)("/api/upload",{method:"POST",body:formData})});return async(files,gps)=>{if(!files||0===files.length)return;const id=crypto.randomUUID(),preview=URL.createObjectURL(files[0]);sessionStorage.setItem(`preview-${id}`,preview);(await Promise.all(Array.from(files).map((file,idx)=>{const formData=new FormData;formData.append("photo",file),formData.append("caseId",id),gps&&(formData.append("lat",String(gps.lat)),formData.append("lon",String(gps.lon)));const upload=uploadMutation.mutateAsync(formData);return 0===idx&&upload.then(()=>{sessionStorage.removeItem(`preview-${id}`)}),upload}))).some(r=>!r.ok)?notify(t("failedUpload")):router.push(`/cases/${id}`)}}},"./src/app/useSession.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Jv:()=>signIn,CI:()=>signOut,wV:()=>useSession});__webpack_require__("./node_modules/.pnpm/next@15.3.3_@babel+core@7.7.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/compiled/react/jsx-runtime.js");const useSession=()=>({data:null}),signIn=()=>{},signOut=()=>{}}}]);